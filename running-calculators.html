<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="author" content="Romain Pellerin" />
        <meta name="keywords" content="romain pellerin, romain, pellerin, portfolio, site personnel, personal website, blog, running, training, marathon" />
        <meta name="geo.placename" content="San Francisco, California, USA" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="all" />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://romainpellerin.eu/theme/css/main.css" type="text/css" />
        <link rel="shortcut icon" href="https://romainpellerin.eu/favicon.ico" />
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-711TXDHP4Q"></script>
        <script>
        function _dntEnabled(dnt, userAgent) {
            'use strict';

            // for old version of IE we need to use the msDoNotTrack property of navigator
            // on newer versions, and newer platforms, this is doNotTrack but, on the window object
            // Safari also exposes the property on the window object.
            var dntStatus = dnt || navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
            var ua = userAgent || navigator.userAgent;

            // List of Windows versions known to not implement DNT according to the standard.
            var anomalousWinVersions = ['Windows NT 6.1', 'Windows NT 6.2', 'Windows NT 6.3'];

            var fxMatch = ua.match(/Firefox\/(\d+)/);
            var ieRegEx = /MSIE|Trident/i;
            var isIE = ieRegEx.test(ua);
            // Matches from Windows up to the first occurance of ; un-greedily
            // http://www.regexr.com/3c2el
            var platform = ua.match(/Windows.+?(?=;)/g);

            // With old versions of IE, DNT did not exist so we simply return false;
            if (isIE && typeof Array.prototype.indexOf !== 'function') {
                return false;
            } else if (fxMatch && parseInt(fxMatch[1], 10) < 32) {
                // Can't say for sure if it is 1 or 0, due to Fx bug 887703
                dntStatus = 'Unspecified';
            } else if (isIE && platform && anomalousWinVersions.indexOf(platform.toString()) !== -1) {
                // default is on, which does not honor the specification
                dntStatus = 'Unspecified';
            } else {
                // sets dntStatus to Disabled or Enabled based on the value returned by the browser.
                // If dntStatus is undefined, it will be set to Unspecified
                dntStatus = { '0': 'Disabled', '1': 'Enabled' }[dntStatus] || 'Unspecified';
            }
            return dntStatus === 'Enabled' ? true : false;
        }
        if (!_dntEnabled() || true) { /* temp ignore DNT */
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-711TXDHP4Q');
        }
        </script>

        <!-- Social media -->
        <meta name="description" content="A bunch of calculators for runners" />
        <meta property="og:image" content="https://romainpellerin.eu/theme/img/romain_pellerin-4x.jpg" />
        <meta property="og:title" content="Running Calculators - Romain Pellerin's Blog" />
        <meta property="og:description" content="A bunch of calculators for runners" />
        <meta property="og:url" content="https://romainpellerin.eu/running-calculators.html" />

        <title>Running Calculators - Romain Pellerin's Blog</title>

        <link href="//romainpellerin.eu/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Romain Pellerin's Blog Atom Feed" />
        <link href="//romainpellerin.eu/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Romain Pellerin's Blog RSS Feed" />
    </head>
    <body>
        <div id="wrapper">

<nav class="flexbox-row">
    <a class="center" href="https://romainpellerin.eu/">Homepage</a>
    <span class="center">|| Blog:</span>
    <a class="center" href="https://romainpellerin.eu/archives.html">All articles</a>
    <a class="center" href="https://romainpellerin.eu/categories.html">Categories</a>
    <a class="center" href="https://romainpellerin.eu/tags.html">Tags</a>
    <a class="center" href="//romainpellerin.eu/feeds/rss.xml">RSS feed</a>
    <a class="center" href="//romainpellerin.eu/feeds/atom.xml">Atom feed</a>
</nav><header class="article-header center">
    <p id="back-line" class="small grey"><span>
<time datetime="2024-08-24T13:00:00+02:00">Sat 24 August 2024</time> - Last update: <time datetime="2025-05-22T16:48:00+02:00">Thu 22 May 2025</time>        </p>
    <h1>Running Calculators</h1>
    <div class="grey">
        <p class="italic">A bunch of calculators for runners</p>
        <p class="small">
            &#128338; <span title="Based on a 200 words per minute reading speed. This article has a total of 2370 words.">12 min read</span>
        </p>
<p class="small">Category: <a title="Go to the category" href="https://romainpellerin.eu/category/running.html">Running</a></p><p class="small">Tags: <a title="Go to the tag" href="https://romainpellerin.eu/tag/running.html">running</a>, <a title="Go to the tag" href="https://romainpellerin.eu/tag/training.html">training</a>, <a title="Go to the tag" href="https://romainpellerin.eu/tag/marathon.html">marathon</a></p>    </div>
</header>
<article>
    <style>
div#menu {
  text-align: center
}

div#menu a {
  display: inline-block;
  padding: 5px;
  border-radius: 5px;
  background: orange;
  margin: 3px;
  text-decoration: none;
}
</style>

<script>
    /* THIS BLOCK OF JS CODE MUST REMAIN AT THE TOP OF THE ARTICLE */
    const matchPaceFormatWithColon = v => v && v.match(/^(\d{1,2}):(\d{2})$/);
    const matchPaceFormatWithQuotes = v => v && v.match(/^(\d{1,2})'(\d{2})"$/);
    const paceToSeconds = (v, separator = 'COLON') => {
            const [, minutes, seconds] = separator === 'COLON' ? matchPaceFormatWithColon(v) : matchPaceFormatWithQuotes(v)
            return Number(minutes) * 60 + Number(seconds)
    }
    const differenceBetweenPaces = (min, max) => paceToSeconds(max) - paceToSeconds(min)
    const secondsToTime = (v) => {
            let minutes = Math.floor(v / 60)
            let hours = 0
            const seconds = String(v % 60).padStart(2, '0')
            if (minutes > 59) {
                    hours = Math.floor(minutes / 60)
                    minutes = String(minutes % 60).padStart(2, '0')
            }
            minutes = String(minutes)
            const result = [String(hours), minutes, seconds]
            result.valueWithQuotes = hours ? `${hours}h${minutes}'${seconds}"` : `${minutes}'${seconds}"`
            result.valueWithColon = hours ? `${hours}:${minutes}:${seconds}` : `${minutes}:${seconds}`
            return result
    }
    const roundTo1 = num => Math.round((num + Number.EPSILON) * 10) / 10
    const paceInSecondsToSpeed = paceInSeconds => roundTo1(3600.0/paceInSeconds) // .toFixed(1) is less precise
    const speedInKmhTimesPercent = (kmh, percent) => (percent * kmh / 100).toFixed(2)
    const paceInSecondsToFinishTime = (paceInSeconds, kms) => secondsToTime(Math.ceil(paceInSeconds * kms)).valueWithColon
    const secondsAtPaceToMeters = (seconds, paceInSeconds) => Math.floor((seconds * 1000) / paceInSeconds)
    const metersAtPaceToSeconds = (meters, paceInSeconds) => Math.ceil((meters * paceInSeconds) / 1000)
    const speedToSecondsForOneKilometer = speed => Math.ceil(3600/speed)

    function createHeadingMenu() {
        const menu = document.querySelector('div#menu');
        if (!menu) return;

        const headings = document.querySelectorAll('h1[id]');
        if (headings.length === 0) return;

        headings.forEach(heading => {
                const listItem = document.createElement('a');

                listItem.setAttribute('href', '#' + heading.id);
                listItem.textContent = heading.textContent;

                menu.appendChild(listItem);
        });
    }

    document.addEventListener("DOMContentLoaded", createHeadingMenu)
</script>

<div id="menu"></div>

<h1 id="running-pace-to-finish-times">Running pace to finish times</h1>
<div id="pace_chart_info">
From <input pattern="\d{1,2}:\d{2}" type="text" id="fastest_pace" placeholder="Fastest pace" value="3:52"/>
to <input pattern="\d{1,2}:\d{2}" type="text" id="slowest_pace" placeholder="Slowest pace" value="4:05"/>

<div class="distance"><input data-kms="42.195" id="marathon" type="checkbox" checked /><label for="marathon">Marathon</label></div>
<div class="distance"><input data-kms="25" id="km25" type="checkbox" /><label for="km25">25 kms</label></div>
<div class="distance"><input data-kms="21.0975" id="half_marathon" type="checkbox" /><label for="half_marathon">Half-marathon</label></div>
<div class="distance"><input data-kms="10" id="km10" type="checkbox" /><label for="km10">10 kms</label></div>
<div class="distance"><input data-kms="5" id="km5" type="checkbox" checked /><label for="km5">5 kms</label></div>
<div class="distance"><input data-kms="custom" type="checkbox" /><input type="number" step="0.1" id="custom" placeholder="Custom distance" value="3.5"/> kms</div>
</div>

<table class="collapse" id="pace_chart_results"></table>

<script>
    const fastestPace = document.querySelector('input#fastest_pace')
    const slowestPace = document.querySelector('input#slowest_pace')
    const custom = document.querySelector('input#custom')

    function paceChartInputChange() {
        custom.parentElement.querySelector('[data-kms]').dataset.kms = custom.value

        const min = fastestPace.value;
        const max = slowestPace.value;

        if (!matchPaceFormatWithColon(min) || !matchPaceFormatWithColon(max) || differenceBetweenPaces(min, max) < 0) return
        const difference = differenceBetweenPaces(min, max) + 1
        const minInSeconds = paceToSeconds(min)

        const table = document.getElementById('pace_chart_results')
        let newTable = "<thead><tr><th>Pace</th><th>Speed</th>"

        const distances = Array.from(document.querySelectorAll('.distance')).map(div => {
                const input = div.querySelector('input[type="checkbox"]')
                const checked = input.checked
                const kms = Number(input.dataset.kms)
                const label = div.querySelector('label')?.innerText ?? `${kms} kms`
                return {checked, kms, label}
        }).filter(({checked})=>checked);

        newTable += `${distances.map(({kms, label}) => `<th>${label}</th>`).join("")}</tr></thead><tbody>`

        const paces = [...new Array(+difference)].map(function(_,i) { return i + minInSeconds })
        const result = paces.map(function(paceInSeconds) {
            const pace = secondsToTime(paceInSeconds).valueWithQuotes + "/km"
            const speed = paceInSecondsToSpeed(paceInSeconds)
            const row = distances.map(({kms}) => `<td>${paceInSecondsToFinishTime(paceInSeconds, kms)}</td>`).join("")

            newTable += `<tr><th>${pace}</th><th>${speed} km/h</th>${row}</tr>`
        })

        newTable += "</tbody>"
        table.innerHTML = newTable
    }

    document.querySelectorAll('#pace_chart_info input').forEach(el => {
        el.addEventListener('input', paceChartInputChange)
    })
    if (fastestPace.value || slowestPace.value) {
        paceChartInputChange()
    }
</script>

<h1 id="zones">Zones</h1>
<p>(<a href="https://en.wikipedia.org/wiki/VVO2max">MAS</a> is <em><a href="https://fr.wikipedia.org/wiki/Vitesse_maximale_a%C3%A9robie">VMA</a></em> in French)</p>
<p>MAS speed (km/h): <input type="number" step="0.01" id="mas" placeholder="MAS speed (km/h)" value="17.34"/>
Max HR: <input type="number" step="1" id="maxhr" placeholder="Max HR" value="202"/></p>
<div>
Percentage: <input type="number" step="1" id="random_percent" placeholder="% of your MAS" value="100"/>%
<span id="random_percent_result"></span>
</div>

<div id="zones_result"></div>

<details><summary>more info</summary>
<a href="https://youtu.be/4QhT_6YgOuI?t=1861">There are multiple scales that exist out there, but none of them will have exactly the same values nor the same zones.</a> Here are two scales that I personnally use. They work for me, they might not for you.
<br /><br />
The first table is greatly inspired by <a href="https://www.facebook.com/lorblanchet/posts/pfbid032J13PKC2rDPA84weL5dXZ9G8GpznZBVwgrqZszF6opB121oEpwqKZ7hjNQ2NCehel">this one</a>, even though I found the given HRmax values way too high, compared to the MAS values. Generally, based on what I read on the internet but also my observations, for any pace, "(percent of MAS plus 5 to 10) = percent of your HRmax" (more or less). So I changed the HRmax values in the first table above and adjusted them to what I observed with my very own heart, at those paces. Most other scales on the internet seem to agree and use the formula "percent of MAS + 5 = percent of HRmax".
<br /><br />
In recent years, many pace charts started using the "heart rate reserve" as their basis, instead of HRmax. I have not dug the topic enough, so I'm not using that (so far). "Heart rate reserve" basically means HRmax - resting heart rate. Not everyone agrees on how the "resting heart rate" should be measured. Lowest value in the night? Lowest value in the day, while sitting and doing nothing? Average value measured during sleep? Therefore, I'm quite reluctant to use this for now.
<br /><br />
The second table, on ventilatory thresholds, is a mashup of multiple articles I've read. I simplified the values to make it easier to understand.
<br /><br />
In <a href="https://youtu.be/k8oADrC5Q1w?t=456">other</a> <a href="https://youtu.be/ZDdZ3TqJkd8?t=471">sources</a>, I've found slightly different values for SV1 (<i>VT1</i> in English) and SV2 (<i>VT2</i> in English). But these values are athlete-dependant anyways. It's never an exact value. And it's different for everyone.
<br /><br />
VT1/SV1 is <a href="https://youtu.be/k8oADrC5Q1w?t=555">slightly slower than marathon pace.</a>
<br /><br />
When people refer to "threshold" only, without specifying 1 or 2, they mean the second one (VT2/SV2). <a href="https://youtu.be/k8oADrC5Q1w?t=570">It's an effort than can be sustained up to an hour.</a> <a href="https://youtu.be/k8oADrC5Q1w?t=526">It's the same as FTP in cycling.</a>

</details>

<script>
  const masInput = document.querySelector('input#mas')
  const maxHrInput = document.querySelector('input#maxhr')
  const randomPercent = document.querySelector('input#random_percent')

  const allZones = [
    {title: "Classic 5 zones", zones: [
      {percentHr: [70], percentMas: [50,60], zone: 1, name: 'Endurance fondamentale'},
      {percentHr: [70,75], percentMas: [60,70], zone: 2, name: 'Endurance active'},
      {percentHr: [75,85], percentMas: [70,80], zone: 3, name: 'Allure marathon'},
      {percentHr: [85,95], percentMas: [80,90], zone: 4, name: 'Allures semi‚Üí10km, allure tempo, allure "au seuil" [ana√©robie]'},
      {percentHr: [95,100], percentMas: [90,100], zone: 5, name: 'Allures 5km‚ÜíVMA'},
    ]},
    {title: "Zones based on ventilatory thresholds", zones: [
      {percentHr: [80], percentMas: [75], zone: 1, name: 'Sous le seuil a√©robie / seuil ventilatoire 1 (SV1) = endurance fondamentale'},
      {percentHr: [80,90], percentMas: [75,85], zone: 2, name: 'Entre le seuil a√©robie (SV1) et ana√©robie (SV2) = allures marathon‚Üísemi'},
      {percentHr: [90,100], percentMas: [85,100], zone: 3, name: 'Au del√† de SV2 = allures 10km‚ÜíVMA'},
    ]}
  ]

  function MASzonesInputChange() {
    if (!masInput.value) return

    document.querySelector('#zones_result').innerHTML = ""
    let randomPercentResult
    if (randomPercent.value) {
      const speed = speedInKmhTimesPercent(masInput.value, randomPercent.value)
      randomPercentResult = `= ${secondsToTime(speedToSecondsForOneKilometer(speed)).valueWithQuotes} (${speed} km/h)`
    }
    else {
      randomPercentResult = ""
    }
    document.querySelector('span#random_percent_result').innerHTML = randomPercentResult

    allZones.forEach(({title, zones }) => {
        let newTable = `<h2>${title}</h2><table class=\"collapse\"><thead><tr><th>Zone</th><th>Name(s)</th><th>% MAS</th><th>% HRmax</th><th>Pace</th></tr></thead><tbody>`

        const hueStep = (120 / (zones.length - 1))
        zones.map(({percentMas,zone,percentHr,name},index,array) => {
          const hue = 120 - (index * hueStep)
          const color = `hsl(${hue}, 100%, 50%)`
          const speeds = percentMas.map(percent => speedInKmhTimesPercent(masInput.value, percent))
          const paces = speeds.map(speed => secondsToTime(speedToSecondsForOneKilometer(speed)).valueWithQuotes)
          const hrs = maxHrInput.value ? percentHr.map(hr => Math.round(maxHrInput.value * hr / 100)) : []
          newTable += `<tr style="background-color: ${color}"><td>${zone}</td><td>${name}</td>`

          // % MAS
          let masRow = ''
          if (percentMas.length === 1) {
                masRow = `<span style="white-space: nowrap;"><= ${percentMas[0]}% (${speeds[0] ?? '?'} km/h)</span>`
          }
          else {
                masRow = percentMas.map((mas,i) => `<span style="white-space: nowrap;">${mas}% (${speeds[i] ?? '?'} km/h)</span>`).join('<br />‚¨áÔ∏è<br />')
          }
          newTable += `<td class="center">${masRow}</td>`

          // % HRmax
          let hrRow = ''
          if (percentHr.length === 1) {
                hrRow = `<span style="white-space: nowrap;"><= ${percentHr[0]}% (${hrs[0] ?? '?'} bpm)</span>`
          }
          else {
                hrRow = percentHr.map((hr,i) => `<span style="white-space: nowrap;">${hr}% (${hrs[i] ?? '?'} bpm)</span>`).join('<br />‚¨áÔ∏è<br />')
          }
          newTable += `<td class="center">${hrRow}</td>`

          // Paces
          newTable += `<td class="center">${paces.join('<br />‚¨áÔ∏è<br />')}</td>`
          newTable += `</tr>`
        })

        newTable += "</tbody></table>"
        document.querySelector('#zones_result').innerHTML += newTable
    })
  }

  masInput.addEventListener('input', MASzonesInputChange)
  maxHrInput.addEventListener('input', MASzonesInputChange)
  randomPercent.addEventListener('input', MASzonesInputChange)
  MASzonesInputChange()
</script>

<h2 id="session-parser-zones-distribution">Session parser - zones distribution</h2>
<p>To categorize the paces into zone 1 (below VT1), zone 2 (VT1 to VT2) or zone 3 (above VT2), the MAS value your entered at the top of this section will be used.</p>
<div style="display: flex">
<textarea style="flex: 1 0 0" id="session_parser" rows="10" cols="0">
30min warm-up 5'53" working towards 5'03"
3000m 3'55"
10min cool-down 5'53"
45min 5'26" working towards 5'03"
20min warm-up 5'53" working towards 5'26"
8x (400m / 1min24 3'32" + 200m recovery 5'53")
10min cool-down 5'53"
6km 5'53" working towards 5'26"
4km 4'57"
</textarea>

<textarea style="flex: 1 0 0; background-color: #ddd" id="session_parser_results" rows="10" cols="0" readonly></textarea>

</div>

<div id="session_parser_zones_results"></div>

<script>
    const sessionParserTextarea = document.querySelector('textarea#session_parser')
    const sessionParserResults = document.querySelector('#session_parser_results')

    const regexWithMultiplicator = /^(?<multiplicator>\d+)\s?x\s?\((?<rest>.*?)\)$/
    const regexWorkingTowards = /(?<paceA>\d{1,2}'\d{2}")\s?working towards\s?(?<paceB>\d{1,2}'\d{2}")/g

    // ([a-z-]+ )? is for recovery/warm-up/cool-down terms
    const regexFindMeters = /(?<meters>\d{2,5})\s?m (?:\/ \dmin\d{1,2} )?([a-z-]+ )?(?<pace>\d{1,2}'\d{2}")/g
    const regexFindKiloMeters = /(?<kilometers>\d{1,2}(\.\d{1,3})?)\s?km ([a-z-]+ )?(?<pace>\d{1,2}'\d{2}")/g
    const regexMinsSecsToDistance = /(?<mins>\d{1,3})\s?mins?(?<secs>\d{1,2})? ([a-z-]+ )?(?<pace>\d{1,2}'\d{2}")/g

    function sessionParserInputChange() {
        const zone1 = [] // % MAS <= 75
        const zone2 = [] // % MAS <= 85
        const zone3 = [] // % MAS > 85

        const vt1Speed = speedInKmhTimesPercent(masInput.value, 75)
        const vt2Speed = speedInKmhTimesPercent(masInput.value, 85)
        const vt1PaceInSeconds = speedToSecondsForOneKilometer(vt1Speed)
        const vt2PaceInSeconds = speedToSecondsForOneKilometer(vt2Speed)

        const lines = sessionParserTextarea.value.split("\n")
        const results = lines.map(l => l.trim()).filter(l => l.length > 0).map(line => {
                let lineToParse = line
                let multiplicator = 1

                let result = lineToParse.match(regexWithMultiplicator)
                if (result) {
                        multiplicator *= result.groups.multiplicator
                        lineToParse = result.groups.rest
                }

                // Let's replace the "working towards" with their average pace
                result = lineToParse.matchAll(regexWorkingTowards)
                for (const match of result) {
                        const {paceA, paceB} = match.groups
                        const toReplace = match[0]
                        let averagePace = Math.ceil((paceToSeconds(paceA, 'QUOTE') + paceToSeconds(paceB, 'QUOTE')) / 2)
                        averagePace = secondsToTime(averagePace).valueWithQuotes
                        lineToParse = lineToParse.replace(toReplace, averagePace)
                }

                // Let's replace `400m 4'57"` with `4000@4'57"`
                result = lineToParse.matchAll(regexFindMeters)
                for (const match of result) {
                        const {meters, pace} = match.groups
                        const toReplace = match[0]
                        const metersAtPace = `${meters}@${pace}`
                        lineToParse = lineToParse.replace(toReplace, metersAtPace)
                }
                // Let's replace `4km 4'57"` with `4000@4'57"`
                result = lineToParse.matchAll(regexFindKiloMeters)
                for (const match of result) {
                        const {kilometers, pace} = match.groups
                        const toReplace = match[0]
                        const metersAtPace = `${Number(kilometers)*1000}@${pace}`
                        lineToParse = lineToParse.replace(toReplace, metersAtPace)
                }
                // Let's replace `10min cool-down 5'53" with 1700@5'53"` with `1700@5'53"`
                result = lineToParse.matchAll(regexMinsSecsToDistance)
                for (const match of result) {
                        const {mins, secs, pace} = match.groups
                        const toReplace = match[0]
                        const paceInSeconds = paceToSeconds(pace, "QUOTES")
                        const meters = secondsAtPaceToMeters((Number(mins) * 60) + Number(secs ?? "0"), paceInSeconds)
                        const metersAtPace = `${meters}@${pace}`
                        lineToParse = lineToParse.replace(toReplace, metersAtPace)
                }

                let segments
                if (lineToParse.includes('+')) {
                        segments = lineToParse.split(/\s?\+\s?/)
                }
                else {
                        segments = [lineToParse]
                }
                if (!segments.every(segment => segment.match(/^\d+@\d{1,2}'\d{2}"$/))) {
                        return "Line could not be parsed"
                }

                segments = segments.map(segment => {
                        let [meters, pace] = segment.split('@')
                        meters *= multiplicator
                        const paceInSeconds = paceToSeconds(pace, "QUOTES")
                        if (paceInSeconds >= vt1PaceInSeconds) zone1.push(meters)
                        else if (paceInSeconds >= vt2PaceInSeconds) zone2.push(meters)
                        else zone3.push(meters)

                        return `${meters}@${pace}`
                })
                return segments.join(" + ")
        })

        sessionParserResults.innerHTML = results.filter(l => l.length > 0).join("\n")

        const metersInZone1 = zone1.reduce((acc, item) => acc + item, 0)
        const metersInZone2 = zone2.reduce((acc, item) => acc + item, 0)
        const metersInZone3 = zone3.reduce((acc, item) => acc + item, 0)
        const zonesResults = document.querySelector('#session_parser_zones_results')
        zonesResults.innerHTML = `Zone 1: ${metersInZone1/1000}kms<br />Zone 2 (faster than ${secondsToTime(vt1PaceInSeconds).valueWithQuotes}): ${metersInZone2/1000}kms<br />Zone 3 (faster than ${secondsToTime(vt2PaceInSeconds).valueWithQuotes}): ${metersInZone3/1000}kms<br /><button id="sessionCopy">Copy</button>`

        const copyContent = async () => {
                try {
                        // Fo google spreadsheet, columns "quality kms in zone 2" and "quality kms in zone 3"
                        await navigator.clipboard.writeText(`${metersInZone2/1000}\t${metersInZone3/1000}`);
                        console.log('Content copied to clipboard');
                } catch (err) {
                        console.error('Failed to copy: ', err);
                }
        }
        document.querySelector('button#sessionCopy').onclick = copyContent
    }
    sessionParserTextarea.addEventListener('input', sessionParserInputChange)
    masInput.addEventListener('input', sessionParserInputChange)
    sessionParserInputChange()
</script>

<h1 id="time-and-distance-converter">Time and distance converter</h1>
<div id="time_and_distance_converter">
<div>Pace: <input pattern="\d{1,2}:\d{2}" type="text" id="time_and_distance_converter_pace" placeholder="Pace" value="4:10"/></div>
<div>What distance will I cover if I run for <input type="number" step="1" id="time_to_distance_mins" value="30"/> minutes and <input type="number" step="1" id="time_to_distance_secs" value="0"/> seconds? <strong id="time_to_distance_results"></strong></div>
<div>How much time do I need to run <input type="number" step="1" id="distance_to_time" value="42195"/> meters? <strong id="distance_to_time_results"></strong></div>
</div>

<script>
    function timeAndDistanceConverterInputChange() {
        const pace = document.querySelector('input#time_and_distance_converter_pace').value
        if (!matchPaceFormatWithColon(pace)) return

        const paceInSeconds = paceToSeconds(pace)

        let timeInSecondsToConvert = Number(document.querySelector('input#time_to_distance_secs').value ?? '0')
        const timeInMinutesToConvert = Number(document.querySelector('input#time_to_distance_mins').value ?? '0')
        timeInSecondsToConvert += (timeInMinutesToConvert * 60)
        const timeConvertedInDistance = secondsAtPaceToMeters(timeInSecondsToConvert, paceInSeconds)
        document.querySelector('#time_to_distance_results').innerText = `${timeConvertedInDistance}m`

        const metersToConvert = Number(document.querySelector('input#distance_to_time').value ?? '0')
        const [hours, minutes, seconds] = secondsToTime(metersAtPaceToSeconds(metersToConvert, paceInSeconds))
        document.querySelector('#distance_to_time_results').innerText = hours ? `${hours}hrs ${minutes}mins ${seconds}secs` : `${minutes}mins ${seconds}secs`
    }
    document.querySelectorAll('#time_and_distance_converter input').forEach(el => {
        el.addEventListener('input', timeAndDistanceConverterInputChange)
    })
    timeAndDistanceConverterInputChange()
</script>

<h1 id="race-sheet">Race sheet</h1>
<div id="race_sheet_info">
<div>
        <label for="race_sheet_distance">Distance:</label>
        <select name="race_sheet_distance" id="race_sheet_distance">
                <option value="marathon">Marathon</option>
                <option value="half_marathon">Half-marathon</option>
                <option value="custom">Custom distance</option>
        </select>
        <input type="number" step="0.1" id="race_sheet_custom_distance" placeholder="Custom distance" value="10"/>
</div>
<div><label for="race_title">Race title (optional):</label> <input type="text" id="race_title" name="race_title" placeholder="City, race name, etc" /></div>
<div><label for="race_date">Race date:</label> <input type="date" id="race_date" name="race_date" /></div>
<div><label for="pace_goal">Pace goal on the watch:</label> <input pattern="\d{1,2}:\d{2}" type="text" id="pace_goal" value="4:30"/></div>
<div><label for="bib_number_pickup_date">Bib number pickup date and time:</label> <input type="datetime-local" id="bib_number_pickup_date" name="bib_number_pickup_date" /></div>
<div>
<label for="nutrition_plan"><a href="https://www.youtube.com/watch?v=COrTo5DUvuo">Nutrition</a> <a href="https://www.maurten.com/fuelguide/">plan</a> (<a href="https://youtu.be/mu7celO4IEE?t=237">your body weight in grams/hour = 75 kgs‚Üíeat 75 grams each hour</a>):</label><br />
<textarea id="nutrition_plan" name="nutrition_plan" rows="5" cols="50">
1x Gel 100 ~15 mins avant course
1x Gel 100 toutes les 20 mins
</textarea>
</div>
<div>
<label for="todo_items">TODO items:</label><br />
<textarea id="todo_items" name="todo_items" rows="5" cols="50">
Une semaine avant course : couper ongles
Pr√©voir le trajet pour se rendre √† la course le dimanche matin
Pr√©voir des vieux v√™tements chauds d'avant course, to give away
Si je dors √† l'h√¥tel, emmener un sharpie + repas
Recharge glucidique √† partir du jeudi, boire du maltodextrine en continu
Samedi matin : shake-out run avec 1km √† allure ~24h avant la course
Samedi matin : se faire une belle moustache
Samedi matin : charger montre et la reboot
Samedi midi et soir : riz, p√¢tes pesto rosso, patates, Speisequark. Pas de l√©gume, pas de gras.
Samedi soir : accrocher bib number au t-shirt et tout pr√©parer/rassembler pour √™tre pr√™t √† partir le dimanche matin
Samedi soir : pr√©parer le petit d√©jeuner (m√ºsli avec lait de soja, p√¢tes pesto rosso OU riz OU Gatosport, banane, Maurten Drink Mix)
Dimanche matin : petit-d√©j AU MOINS 1.5h avant la course
Dimanche matin : noter dans les mains au marqueur
  Montre en mode pace sur distance 42.75kms
  Water stations: Km 5, 10, etc
  WC: Km 5, 10, etc
Dimanche matin : v√©rifier pas de cailloux dans chaussures, double noeud lacets
Dimanche matin : prendre casquette, lunettes, HRM chest strap, manchons, mouchoirs üöΩ dans une poche et mini bouteille d'eau pour boire avant le d√©part
Dimanche matin : warm up de 2kms avant d√©part
</textarea>
</div>
</div>

<div id="race_sheet" style="border: 1px solid gray; padding: 10px;">
        <h2 style="text-align:center">Unknown race - unknown date</h2>
        <p style="text-align:center;font-style:italic" id="race_sheet_subtitle"></p>
        <h3>Pace goal on the watch = <span id="race_pace_goal">?</span></h3>
        <ul>
                <li>Projected finish time with no margin of error (100% accurate GPS): <strong><span id="race_pace_goal_finish_time">?</span></strong></li>
                <li>Projected finish time with a <span id="race_pace_goal_finish_time_margin_error">?</span></li>
                <li>Speed: <strong><span id="race_pace_goal_speed">/</span> km/h</strong></li>
        </ul>
        <h3>Nutrition</h3>
        <ul id="race_sheet_nutrition">
        </ul>
        <h3>TODO until the race</h3>
        <ul id="race_todo" style="list-style-type:none;">
                <li id="race_bib_pickup_date_li"><input type="checkbox">Bib number pickup: <span id="race_bib_pickup_date">Sat 4 Mai</span></li>
        </ul>
</div>
<p><button onclick="printSheet()">Print the sheet</button></p>
<script>
    function raceSheetInputChange() {
        const preDefinedDistances = {
                'marathon': [42.195, 'Marathon'],
                'half_marathon': [21.0975, 'Half-marathon']
        }

        const raceCustomDistance = document.querySelector('#race_sheet_custom_distance')
        const raceDistance = document.querySelector('#race_sheet_distance').value
        const customRaceDistanceSelected = raceDistance === 'custom'
        raceCustomDistance.style = customRaceDistanceSelected ? '' : 'display:none';
        const [kms, label] = customRaceDistanceSelected ? [Number(raceCustomDistance.value), "Race"] : preDefinedDistances[raceDistance]

        // Sheet title and subtitle
        const dateValue = document.querySelector('#race_date').value
        const date = dateValue ? new Date(dateValue).toDateString() : 'unknown date'
        const title = document.querySelector('#race_title').value?.trim()
        let sheetTitle = label
        if (title) {
                sheetTitle += ` - ${title}`
        }
        document.querySelector('#race_sheet h2').innerText = `${sheetTitle} - ${date}`

        // Race distance
        document.querySelector('#race_sheet_subtitle').innerHTML = `${kms} kms`

        // Pace goal
        const paceGoal = document.querySelector('#pace_goal').value
        if (matchPaceFormatWithColon(paceGoal)) {
                const paceInSeconds = paceToSeconds(paceGoal)

                document.querySelector('#race_sheet #race_pace_goal').innerText = secondsToTime(paceInSeconds).valueWithQuotes
                document.querySelector('#race_sheet #race_pace_goal_finish_time').innerHTML = paceInSecondsToFinishTime(paceInSeconds, kms)
                const marginOfErrorInPercent = 1.5
                const marginOfError = ((marginOfErrorInPercent + 100) / 100).toFixed(3)
                const kmsWithError = (kms*marginOfError).toFixed(3)
                document.querySelector('#race_pace_goal_finish_time_margin_error').innerHTML = `${marginOfErrorInPercent}% margin of error (${kmsWithError} kms): <strong>${paceInSecondsToFinishTime(paceInSeconds, kmsWithError)}</strong>`
                document.querySelector('#race_sheet #race_pace_goal_speed').innerText = paceInSecondsToSpeed(paceInSeconds)
        }

        // Nutrition
        const nutritionItems = document.querySelector('#nutrition_plan').value.split("\n").map(e => e.trim()).filter(Boolean)
        const raceNutritionList = document.querySelector('#race_sheet_nutrition')
        raceNutritionList.innerHTML = ''
        nutritionItems.forEach(line => {
                const li = document.createElement('li')
                li.innerText = line
                raceNutritionList.appendChild(li)
        })

        // TODO list
        const todoItems = document.querySelector('#todo_items').value.split("\n").map(e => e.trimEnd()).filter(Boolean)
        const raceTodoList = document.querySelector('#race_todo')
        Array.from(raceTodoList.children).forEach(li => {
                if (!li.matches('#race_bib_pickup_date_li')) {
                        li.remove();
                }
        })
        let parentLi, currentUl = raceTodoList, rootUl = raceTodoList
        todoItems.forEach(line => {
                const li = document.createElement('li')

                if (line.startsWith(' ') && parentLi) {
                        if (currentUl === rootUl) {
                                currentUl = document.createElement('ul')
                                parentLi.appendChild(currentUl)
                        }
                }
                else {
                        currentUl = rootUl
                }

                li.innerHTML = `<input type="checkbox">${line}`
                currentUl.appendChild(li)
                parentLi = li
        })

        // Bib pickup date
        const bibNumberPickupDateValue = document.querySelector('#bib_number_pickup_date').value
        const bibNumberPickupDate = bibNumberPickupDateValue ? new Date(bibNumberPickupDateValue) : 'unknown date'
        document.querySelector('#race_bib_pickup_date').innerText =
                typeof bibNumberPickupDate === 'string'
                ? bibNumberPickupDate
                : `${bibNumberPickupDate.toDateString()}, ${bibNumberPickupDate.toLocaleTimeString()}`
    }

    document.querySelectorAll('#race_sheet_info input, #race_sheet_info select, #race_sheet_info textarea').forEach(el => {
        el.addEventListener('input', raceSheetInputChange)
    })
    raceSheetInputChange()

    window.printSheet = () => {
        const elem = document.querySelector('#race_sheet');
        const printWindow = window.open('', 'PRINT', 'height=600,width=800');
        printWindow.document.write('<html><head><title>Race sheet</title>');
        printWindow.document.write('</head><body>');
        printWindow.document.write(elem.innerHTML);
        printWindow.document.write('</body></html>');

        printWindow.print();
        printWindow.close();

        return true;
    }
</script>
</article>
<footer class="grey italic small">
    Last update: Thu 22 May 2025</footer>

        </div> <!-- WRAPPER -->
    </body>
</html>