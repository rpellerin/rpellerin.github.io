<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="author" content="Romain Pellerin" />
        <meta name="keywords" content="romain pellerin, romain, pellerin, portfolio, site personnel, personal website, blog, hacking, standing desk, diy" />
        <meta name="geo.placename" content="San Francisco, California, USA" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="all" />
        <link rel="stylesheet" href="//romainpellerin.eu/theme/css/main.css" type="text/css" />
        <link rel="shortcut icon" href="//romainpellerin.eu/favicon.ico" />

        <script>
        function _dntEnabled(dnt, userAgent) {
            'use strict';

            // for old version of IE we need to use the msDoNotTrack property of navigator
            // on newer versions, and newer platforms, this is doNotTrack but, on the window object
            // Safari also exposes the property on the window object.
            var dntStatus = dnt || navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
            var ua = userAgent || navigator.userAgent;

            // List of Windows versions known to not implement DNT according to the standard.
            var anomalousWinVersions = ['Windows NT 6.1', 'Windows NT 6.2', 'Windows NT 6.3'];

            var fxMatch = ua.match(/Firefox\/(\d+)/);
            var ieRegEx = /MSIE|Trident/i;
            var isIE = ieRegEx.test(ua);
            // Matches from Windows up to the first occurance of ; un-greedily
            // http://www.regexr.com/3c2el
            var platform = ua.match(/Windows.+?(?=;)/g);

            // With old versions of IE, DNT did not exist so we simply return false;
            if (isIE && typeof Array.prototype.indexOf !== 'function') {
                return false;
            } else if (fxMatch && parseInt(fxMatch[1], 10) < 32) {
                // Can't say for sure if it is 1 or 0, due to Fx bug 887703
                dntStatus = 'Unspecified';
            } else if (isIE && platform && anomalousWinVersions.indexOf(platform.toString()) !== -1) {
                // default is on, which does not honor the specification
                dntStatus = 'Unspecified';
            } else {
                // sets dntStatus to Disabled or Enabled based on the value returned by the browser.
                // If dntStatus is undefined, it will be set to Unspecified
                dntStatus = { '0': 'Disabled', '1': 'Enabled' }[dntStatus] || 'Unspecified';
            }
            return dntStatus === 'Enabled' ? true : false;
        }
        if (!_dntEnabled()) {
            // Analytics here
        }
        </script>

        <!-- Social media -->
        <meta name="twitter:card" content="summary" />
        <meta name="twitter:site" content="@romainpellerin" />
        <meta name="description" content="Tutorial about how I motorized my IKEA Starska standing desk" />
        <meta property="og:image" name="twitter:image" content="//romainpellerin.eu/theme/img/romain_pellerin-1x.jpg" />
        <meta property="og:title" name="twitter:title" content="Motorizing an IKEA Skarsta Standing Desk - Romain Pellerin's Blog" />
        <meta property="og:description" name="twitter:description" content="Tutorial about how I motorized my IKEA Starska standing desk" />

        <title>Motorizing an IKEA Skarsta Standing Desk - Romain Pellerin's Blog</title>

        <link href="//romainpellerin.eu/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="Romain Pellerin's Blog Atom Feed" />
        <link href="//romainpellerin.eu/feeds/rss.xml" type="application/rss+xml" rel="alternate" title="Romain Pellerin's Blog RSS Feed" />
    </head>
    <body>
        <div id="wrapper">

<nav class="flexbox-row">
    <a class="center" href="//romainpellerin.eu/">Homepage</a>
    <span class="center">|| Blog:</span>
    <a class="center" href="//romainpellerin.eu/archives.html">Archives (all posts)</a>
    <a class="center" href="//romainpellerin.eu/categories.html">Categories</a>
    <a class="center" href="//romainpellerin.eu/tags.html">Tags</a>
    <a class="center" href="//romainpellerin.eu/feeds/rss.xml">RSS feed</a>
    <a class="center" href="//romainpellerin.eu/feeds/atom.xml">Atom feed</a>
</nav><header class="article-header center">
    <p id="back-line" class="small grey"><span>
<time datetime="2023-03-14T23:00:00+01:00">Tue 14 March 2023</time> - Last update: <time datetime="2024-05-03T10:17:00+02:00">Fri 03 May 2024</time>        </p>
    <h1>Motorizing an IKEA Skarsta Standing Desk</h1>
    <div class="grey">
        <p class="italic">Tutorial about how I motorized my IKEA Starska standing desk</p>
        <p class="small">
            &#128338; <span title="Based on a 200 words per minute reading speed. This article has a total of 2445 words.">12 min read</span>
        </p>
<p class="small">Category: <a title="Go to the category" href="//romainpellerin.eu/category/miscellaneous.html">Miscellaneous</a></p><p class="small">Tags: <a title="Go to the tag" href="//romainpellerin.eu/tag/hacking.html">hacking</a>, <a title="Go to the tag" href="//romainpellerin.eu/tag/standing-desk.html">standing desk</a>, <a title="Go to the tag" href="//romainpellerin.eu/tag/diy.html">diy</a></p>    </div>
</header>
<article>
    <p><strong>UPDATE 2024: after dreaming about it for about a year, the V2 of this project finally came to be. Scroll all the way down to read about it!</strong></p>
<p>I got really tired of turning the crank of my IKEA Starska standing desk multiple times a day. Not only this is tedious, but also I can't keep on typing or using my mouse while doing so. And if I'm in a meeting, I look stupid. So I decided to motorize it. I know IKEA already sells an electrical version of it with a motor, but it's 200 euros more expensive and I already had one desk. Plus I like challenges!</p>
<p>After hours of googling and reading various blog posts (see the bottom of this page for links), after days spent waiting for all my orders to arrive, after minutes of tinkering, I finally got a working prototype!</p>
<video controls>
  <source src="./videos/motorizing-an-ikea-skarsta-standing-desk.mp4" type="video/mp4">
</video>

<p>That's far from perfect, I already have ideas about how to improve it, but for now that'll do... Down below is the shopping list for this project and the steps to build it. I hope this helps!</p>
<h1 id="hardware">Hardware</h1>
<h2 id="dc-12v-gear-motor-37d-mm">DC 12V Gear Motor (37D mm)</h2>
<ul>
<li>Not just a regular DC motor. See <a href="https://electronics.stackexchange.com/questions/97477/difference-between-a-dc-motor-and-gear-motor">the difference between a regular DC motor and a DC gear motor</a></li>
<li>The diameter must be 37 mm, so that it fits perfectly under the IKEA Starska standing desk</li>
<li>Torque must be equal to or greater than 2Nm (20.4 kg.cm) (info found <a href="http://cesarmoya.com/blog/motorizing-standup-desk/">here</a>). Look at the stall torque, not the rated torque.</li>
</ul>
<figure class="center">
<img class="zoomable" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/motor.jpg" alt="A picture of the motor" />
<figcaption>The motor I bought from Aliexpress</figcaption>
</figure>

<p>I bought and tried these 2, <a href="https://de.aliexpress.com/item/32968002582.html">the 12V 72 RPM edition, that draws 3 amps ("stall current"), and the 12V 136 RPM one</a>. According to the specs of the 72 RPM one, the stall torque is greater than 30 Kg.cm and it works perfectly! I can put weight on the desk (I tried more than 30 Kg) and it still raises the desk up easily! As to the 136 RPM, it works well too, up to 30 Kg, but it gets real close to stalling. Without much weight (a laptop and a monitor), it raises the desk at about 100 rotations per minute.</p>
<p>9.36 euros</p>
<figure class="center">
<img class="zoomable" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/motor-specs.jpg" alt="A table showing the specs of the motor" />
<figcaption>Specs of the motor</figcaption>
</figure>

<p>Alternatively, <a href="https://www.pololu.com/product/4745">this other motor looks like a viable option too</a>.</p>
<h2 id="aluminum-l-bracket-for-37d-metal-gearmotors">Aluminum L-Bracket for 37D Metal Gearmotors</h2>
<figure class="center">
<img class="zoomable" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/l-bracket-for-37d-motors.jpg" alt="A picture of a pair of L-Brackets for motors" />
<figcaption>The L-Bracket pair I got (only 1 is necessary for this project though)</figcaption>
</figure>

<p>We will use this to secure the motor to the desk. <a href="https://thepihut.com/products/pololu-stamped-aluminum-l-bracket-pair-for-37d-metal-gearmotors">I got it from The PiHut</a>. ¬£8.25</p>
<h2 id="power-adapter-input-ac-110-240v-output-dc-12v-5a">Power adapter INPUT AC 110-240V / OUTPUT DC 12V 5A</h2>
<figure class="center">
<img class="zoomable" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/acdc-power-adapter.jpg" alt="A picture of a power adapter" />
<figcaption>The adaper I got from Amazon</figcaption>
</figure>

<p><a href="https://www.amazon.de/12V-voltage-transformer-power-adapter/dp/B07L5GP7SD">I got this one from Amazon</a>, works like a charm! 14.99 euros.</p>
<h2 id="6mm-hex-key">6mm hex key</h2>
<figure class="center">
<img class="zoomable" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/6mm-hex-key.jpg" alt="A picture of an hex key" />
<figcaption>The 6mm hex key I got</figcaption>
</figure>

<p><a href="https://www.obi.de/schluessel-abzieher/lux-sechskant-schluessel-comfort-6-mm/p/3471075">I got this one Obi.de</a> and I had to cut off the bent part of it. This will replace the original crank provided with the desk. 4.49 euros.</p>
<h2 id="7mm-shaft-coupler">7mm shaft coupler</h2>
<figure class="center">
<img class="zoomable" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/7mm-shaft-coupler.jpg" alt="A picture of a shaft coupler" />
<figcaption>The 7mm shaft coupler I got</figcaption>
</figure>

<p>This will connect the motor to the hex key in the desk. Get a <a href="https://www.amazon.de/dp/B07HKJL1XC">7mm shaft coupler</a>, since the motor comes with a 6mm D-shaped shaft. The hex shaft for the desk is 6mm too, so the shaft coupler must be 1mm larger. 8.27 euros.</p>
<h2 id="dc-motor-driver">DC motor driver</h2>
<figure class="center">
<img class="zoomable" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/dc-motor-driver.jpg" alt="A picture of a DC motor driver" />
<figcaption>The DC motor driver I got from Cytron.io</figcaption>
</figure>

<p>This will control the motor. I went with the <a href="https://www.cytron.io/p-10-amp-7v-30v-potentiometer-and-switch-control-dc-motor-driver">MD10-POT from Cytron</a>, that comes with a potentiometer (adjust speed) and switch (2 directions and stop), and that does not require any Arduino nor any code writing.</p>
<p><strong>Careful</strong>: this is a regenerative motor driver (<a href="https://www.cytron.io/tutorial/md10-pot-controlling-dc-motor-without-writing-code">as described at the bottom here</a>), meaning that when you stop powering the motor, it keeps spinning a bit before coming to a stop (due to inertia, while it's "braking"), and as a result the current flows back to the power source. As a consequence this driver should be used with a battery, not a switching power supply, because a battery can be charged but with a switching power supply the current has nowhere to go. For this project it is ok though as the desk is heavy and won't allow the motor to keep spinning when the power is cut.</p>
<p>Learn more about <a href="https://www.cytron.io/tutorial/5-easiest-ways-control-dc-motor">controlling a DC motor here</a>.</p>
<p>I bought mine on <a href="https://botland.de/motortreiber-module/13450-cytron-md10-pot-dc-30v-10a-motortreiber-schalter-potentiometer-5904422377274.html">Botland.de</a>. 12.48 euros.</p>
<h2 id="dc-connector-barrel-plug-adapter-25mm-x-55mm">DC Connector Barrel Plug Adapter 2.5mm x 5.5mm</h2>
<figure class="center">
<img class="zoomable" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/dc-connector-barrel-plug-adapter.jpg" alt="A picture of a DC connector barrel plug adapter" />
<figcaption>The one I got</figcaption>
</figure>

<p>This is used to connect the DC power supply with the motor driver, <a href="https://www.amazon.de/dp/B09TB4D8ZT">I got two from Amazon</a>. 4.99 euros.</p>
<h2 id="misc">Misc</h2>
<ul>
<li>Duct tape</li>
<li>A grinder, to cut off the bent part of the hex key</li>
<li>Electrical wire</li>
</ul>
<h1 id="how-to-build-it">How to build it</h1>
<ol>
<li>Cut off the bent part of the hex key with a grinder. We need a straight hex key.</li>
<li>Replace the original crank with the hex key, mounted with the shaft coupler.</li>
<li>Position the L-bracket with the motor at the end of the hex key and mark the final position with a pen.</li>
<li>Screw the L-bracket to the desk using a drill (slow speed)</li>
</ol>
<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/step-4.jpg" alt="A picture the L-bracket attached to the desk" />
  <figcaption>The L-bracket is now attached to the desk</figcaption>
</figure>

<ol>
<li>Secure the motor to the L-bracket</li>
</ol>
<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/step-5.jpg" alt="A picture of the motor attached to the L-bracket" />
  <figcaption>The motor is now attached to the L-bracket</figcaption>
</figure>

<ol>
<li>Attach the power supply to the desk with a self-adhesive velcro, or just tape:</li>
</ol>
<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/step-6a.jpg" alt="A piece of self-adhesive velcro" />
  <figcaption>Self-adhesive velcro</figcaption>
</figure>
<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/step-6b.jpg" alt="A picture of velcro under the desk" />
  <figcaption>Velcro stuck to the desk</figcaption>
</figure>
<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/step-6c.jpg" alt="A picture showing the power supply wrapped in velcro and attached to the desk" />
  <figcaption>The power supply wrapped in velcro</figcaption>
</figure>

<ol>
<li>Connect the motor to the DC motor driver using wires, and tape the junctions for improved safety</li>
</ol>
<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/step-7a.jpg" alt="A picture showing the taped junctions between the motor and the wires" />
  <figcaption>Put tape around the connections</figcaption>
</figure>

<ol>
<li>Connect the power supply to the DC motor driver (pay attention to polarity) using the barrel and wrap it in tape for improved safety</li>
</ol>
<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/step-8.jpg" alt="A picture showing the power supply connected to the DC motor driver using the barel" />
  <figcaption>The barrel, connecting the DC motor driver and power supply, wrapped in tape</figcaption>
</figure>

<ol>
<li>And last, tape everything under the desk, make sure nothing is hanging. I protected some parts (soldered points) of the motor driver board with tape. I placed the switch button near the edge of the desk to reach it easily. A better design would be to put everything in a small plastic box.</li>
</ol>
<figure class="center">
  <img class="zoomable big" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/step-9.jpg" alt="A picture showing the end result" />
  <figcaption>The end result</figcaption>
</figure>

<h1 id="a-v2-of-my-project-would-be">A V2 of my project would be...</h1>
<p>With a <a href="https://www.cytron.io/c-motor-and-motor-driver/c-motor-driver/c-dc-motor-driver">different motor driver</a>, that has "Over Current" and "Under Voltage" protections, such as the MD13S from Cytron. Also with an Arduino and auto-raise feature based on how long it takes to raise/lower it. I don't need to have multiple programmable positions, nor an OLED screen. An auto-raise/lower feature can be tricky, for the following reasons (copy/pasted from <a href="https://github.com/cesar-moya/arduino-power-desktop/blob/master/MotorControl/MotorControl.ino">https://github.com/cesar-moya/arduino-power-desktop/blob/master/MotorControl/MotorControl.ino</a>):</p>
<blockquote>
<p>If you activate auto-raise, and your desk was already at the maximum height,
then - depending on your desk - on the IKEA SKARSTA it will hit a stopping
point and the MOTORS WILL STALL for the amount of seconds that you recorded.
In other words, if you recorded 30 seconds to raise, and your desk is
already at the top position (or close), and you still enable auto-raise, you
risk damaging your motors as a full power will be sent to them but they will
be blocked. When using auto-raise and auto-lower you must ALWAYS be present
and watching the desk, ready to cancel the operation if the motors stall for
any reason.</p>
</blockquote>
<p>And finally, a nicer design, where everything is not taped underneath but put in a plastic box.</p>
<h1 id="upgrade-2024-version-2">Upgrade 2024: version 2!</h1>
<p>To upgrade the desk, I wanted to make it smarter. I was tired of having to manually stop the desk at the desired height. I wanted to simply press a button, and it would raise/lower itself to the desired pre-defined position automatically, alone, while I'd be gone pooring myself some coffee üòÅ.</p>
<p>To achieve this, I decided to implement the following logic:</p>
<ul>
<li>Hardcode the maximum and minimum desired height in the code, based on my very own height and chair üòÑ. The current desk height could be measured with a sensor.</li>
<li>BUT, if anything was in the way of the sensor (like a foot!), the measures would be off. To prevent the desk from raising too high for instance, I needed another safeguard: a maximum run time (time during which the motor is either raising or lowering the desk). Actually two values, cause the motor is quicker at lowering the desk than raising it.</li>
</ul>
<p>For this V2, we're gonna reuse most of the what we used for the V1, but we'll also need additionally:</p>
<ul>
<li><a href="https://www.berrybase.de/arduino-uno-r4-minima">Arduino Uno R4 Minima - 19.9 euros</a></li>
<li><a href="https://www.amazon.de/dp/B0825RCZJS">2 push buttons - 7.99 euros for 7 buttons</a>: one to raise the desk, one to lower it</li>
<li><a href="https://www.berrybase.de/metallschichtwiderstand-10-0-kohm-1/4w-1-0207-axial-durchsteckmontage">2 10K-Ohm resistors - 0.05 euros each</a>, for the buttons (<a href="https://docs.arduino.cc/built-in-examples/digital/InputPullupSeriale">despite the Arduino having an internal pullup resistor that can be used</a>, <a href="https://forum.arduino.cc/t/resistor-why/108705/2">it's not reliable</a> <a href="https://forum.arduino.cc/t/push-buttons-and-resistors-why-and-how/584493">enough</a>). Prefer metal film over carbon, supposedly they're more robust.</li>
<li><a href="https://www.berrybase.de/pololu-tb6612fng-dualer-motortreiber">Pololu TB6612FNG motor driver - 4.20 euros</a></li>
<li><a href="https://www.berrybase.de/hc-sr04-ultraschall-sensor">HC-SR04 distance sensor - 1.49 euros</a></li>
<li><a href="https://www.amazon.de/dp/B0983NSV6F">A 200*120*55mm junction box - 12.34 euros</a></li>
<li><a href="https://www.amazon.de/dp/B0CBWTZNM5">2.54mm screw terminal blocks / screwshield - 7.59 euros</a></li>
<li>
<p>Tape and wires:</p>
<ul>
<li><a href="https://www.amazon.de/dp/B07K8PVKBP">male-female</a>: 4.49 euros</li>
<li><a href="https://www.amazon.de/dp/B07KKJ69DV">male-male</a>: 4.49 euros</li>
<li><a href="https://www.amazon.de/dp/B07KYHBVR7">female-female</a>: 4.49 euros</li>
<li><a href="https://www.amazon.de/dp/B09NSN458Y">2-male-to-1-female</a>: 11.98 euros</li>
</ul>
</li>
</ul>
<p>No need for a buck converter, we'll plug the Arduino Uno R4 minima directly to the 12V power supply through its VIN pin, which accepts <a href="https://docs.arduino.cc/tutorials/uno-r4-minima/cheat-sheet/">voltage ranging from 6 to 24V</a>. See why just below.</p>
<h2 id="a-few-words-on-the-motor-driver">A few words on the motor driver</h2>
<p>A lot of online tutorials recommend using the classic L298N for Arduino projects. Hower, a lot of people report issues with it on the Arduino forum. A common reply is <a href="https://forum.arduino.cc/t/l298n-is-a-mess-helppp/903638">that the L298N motor driver is old and obsolete</a>, one of its flaws is the 5V drop. People often suggest using modern motor drivers from <a href="https://www.pololu.com/">Pololu</a>, and the <a href="https://www.pololu.com/product/713">TB6612FNG</a> seemed like a good affordable option, even if it supports 2 motors and I'm only using it for one.</p>
<p>To set up the TB6612FNG, I followed <a href="https://adam-meyer.com/arduino/TB6612FNG">this tutorial</a>. Like in the tutorial, I initially wanted to power the Arduino through the 5V output pin of the motor driver (VCC), which would be powered directly by the 12V power supply, but I could not get this to work. Measuring voltage between the GRD and VCC pins of the motor driver never showed anything beyond 3V. So I plugged the Arduino directly on the power supply, through its VIN and GND pins.</p>
<h2 id="arduino-ide">Arduino IDE</h2>
<p>For the Arduino IDE to work on a desktop Linux distro with a R4 Minima board, I had to write:</p>
<div class="highlight"><pre><span></span><code>SUBSYSTEMS==&quot;usb&quot;, ATTRS{idVendor}==&quot;2341&quot;, ATTRS{idProduct}==&quot;0069&quot;, GROUP=&quot;plugdev&quot;, MODE=&quot;0666&quot;
SUBSYSTEMS==&quot;usb&quot;, ATTRS{idVendor}==&quot;2341&quot;, ATTRS{idProduct}==&quot;0369&quot;, GROUP=&quot;plugdev&quot;, MODE=&quot;0666&quot;
</code></pre></div>

<p>in <code>/etc/udev/rules.d/99-arduino-uno-r4.rules</code>. Then <code>sudo udevadm control --reload-rules &amp;&amp; sudo udevadm trigger</code>.</p>
<h2 id="soldering">Soldering</h2>
<p>As you can see further below in the schematic, a bit of soldering is required, specifically if you want to avoid using a breadboard, when connecting 3 wires together, for instance.</p>
<video controls>
    <source src="./videos/standing-desk-soldering.mp4" type="video/mp4">
</video>

<h2 id="schematic-and-photos">Schematic and photos</h2>
<figure class="center">
<img class="zoomable big" src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/standing-desk_bb.png" alt="Fritzing schematic" />
<figcaption>Schematic of the whole wiring</figcaption>
</figure>

<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/distance-sensor.jpg" alt="A photo of the distance sensor" />
  <figcaption>The distance sensor, outside the box</figcaption>
</figure>

<figure class="center">
  <img src="//romainpellerin.eu/images/motorizing-an-ikea-skarsta-standing-desk/v2.jpg" alt="A picture of all the components inside the box" />
  <figcaption>Inside the box</figcaption>
</figure>

<p>The box is attached to the desk with 2 screws, that can be seen in the photo above, sticking out in the box. The screws are directly screwed in the desk.</p>
<h2 id="code">Code</h2>
<p>Now, here's the Arduino code:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Distance sensor pins</span>
<span class="cp">#define TRIGGER_PIN 5</span>
<span class="cp">#define ECHO_PIN 7</span>

<span class="c1">// Motor driver pins</span>
<span class="cp">#define STBY_PIN 10</span>
<span class="cp">#define AIN1_PIN 3</span>
<span class="cp">#define AIN2_PIN 4</span>
<span class="cp">#define PWMA_PIN 6</span>

<span class="c1">// Buttons</span>
<span class="cp">#define LOWER_DESK_BUTTON 13</span>
<span class="cp">#define RAISE_DESK_BUTTON 12</span>

<span class="c1">// Moving states</span>
<span class="cp">#define LOWER_DIRECTION 0</span>
<span class="cp">#define RAISE_DIRECTION 1</span>
<span class="cp">#define IDLE -1</span>

<span class="c1">// Settings</span>
<span class="cp">#define MIN_HEIGHT 66.5</span>
<span class="cp">#define MAX_HEIGHT 106.0</span>
<span class="cp">#define LOWER_TIME_OUT_AFTER_MS 43000</span>
<span class="cp">#define RAISE_TIME_OUT_AFTER_MS 59000</span>
<span class="cp">#define LOOP_DELAY 100</span>
<span class="cp">#define IGNORE_DELTA_IN_CM_GREATHER_THAN 1.5</span>

<span class="c1">// Distance sensor variables</span>
<span class="kt">long</span><span class="w"> </span><span class="n">duration</span><span class="p">;</span><span class="w"></span>
<span class="kt">float</span><span class="w"> </span><span class="n">deltaWithLastKnownCm</span><span class="w"> </span><span class="p">,</span><span class="n">cm</span><span class="p">,</span><span class="w"> </span><span class="n">lastKnownCm</span><span class="p">;</span><span class="w"></span>

<span class="c1">// Moving state variables</span>
<span class="kt">int</span><span class="w"> </span><span class="n">movingDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IDLE</span><span class="p">;</span><span class="w"></span>
<span class="kt">int</span><span class="w"> </span><span class="n">movingStartedAt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">// in milliseconds</span>

<span class="kt">float</span><span class="w"> </span><span class="nf">readHeight</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="c1">//The sensor is triggered by a HIGH pulse of 10 or more microseconds.</span>
<span class="w">  </span><span class="c1">//Give a short LOW pulse beforehand to ensure a clean HIGH pulse:</span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">TRIGGER_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">LOW</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">delayMicroseconds</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">TRIGGER_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">HIGH</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">delayMicroseconds</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">TRIGGER_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">LOW</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="c1">// Read the signal from the sensor: a HIGH pulse whose</span>
<span class="w">  </span><span class="c1">// duration is the time (in microseconds) from the sending</span>
<span class="w">  </span><span class="c1">// of the ping to the reception of its echo off of an object.</span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">ECHO_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">INPUT</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pulseIn</span><span class="p">(</span><span class="n">ECHO_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">HIGH</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="p">)(</span><span class="n">duration</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.0343</span><span class="p">;</span><span class="w"> </span><span class="c1">// Convert the time into a distance</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">9600</span><span class="p">);</span><span class="w"> </span><span class="c1">// Enable logs</span>

<span class="w">  </span><span class="c1">// Distance sensor</span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">TRIGGER_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">ECHO_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">INPUT</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="c1">// Buttons</span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">LOWER_DESK_BUTTON</span><span class="p">,</span><span class="w"> </span><span class="n">INPUT</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">RAISE_DESK_BUTTON</span><span class="p">,</span><span class="w"> </span><span class="n">INPUT</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="c1">// Motor</span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">STBY_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">PWMA_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">AIN1_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">pinMode</span><span class="p">(</span><span class="n">AIN2_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">OUTPUT</span><span class="p">);</span><span class="w"></span>

<span class="w">  </span><span class="c1">// while (!Serial); // While the serial stream is not open, do nothing. FOR DEBUGGING ONLY, when the logs from line 73 are needed.</span>
<span class="w">  </span><span class="n">lastKnownCm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readHeight</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="c1">// Serial.println(&quot;SETUP!!! Height: &quot; + String(cm) + &quot; cm; Lastknowncm: &quot; + lastKnownCm + &quot; cm&quot;);</span>
<span class="w">  </span><span class="n">delay</span><span class="p">(</span><span class="n">LOOP_DELAY</span><span class="p">);</span><span class="w"> </span><span class="c1">// Needed, otherwise the very next reading of height won&#39;t work, we&#39;d have to wait the second call to loop()...</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">loop</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="n">cm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">readHeight</span><span class="p">();</span><span class="w"></span>
<span class="w">  </span><span class="n">deltaWithLastKnownCm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">cm</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lastKnownCm</span><span class="p">);</span><span class="w"> </span><span class="c1">// Sometimes we get odd random readings, wildly different from the previous one. We must ignore those.</span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Height: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; cm; Delta with last reading: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">deltaWithLastKnownCm</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; cm&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">lastKnownCm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cm</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="n">boolean</span><span class="w"> </span><span class="n">isMoving</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">movingDirection</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">IDLE</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isMoving</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">movingStartedAt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">movingStartedAt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">LOOP_DELAY</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Moving time: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">String</span><span class="p">(</span><span class="n">movingStartedAt</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; seconds&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">movingDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">RAISE_DIRECTION</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cm</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">MAX_HEIGHT</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">deltaWithLastKnownCm</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">IGNORE_DELTA_IN_CM_GREATHER_THAN</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Too high!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">movingStartedAt</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">RAISE_TIME_OUT_AFTER_MS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Raise timed out!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">movingDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LOWER_DIRECTION</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cm</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">MIN_HEIGHT</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">deltaWithLastKnownCm</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">IGNORE_DELTA_IN_CM_GREATHER_THAN</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Too low!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">movingStartedAt</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">LOWER_TIME_OUT_AFTER_MS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Lower timed out!&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">LOWER_DESK_BUTTON</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HIGH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Lower Button is pressed&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isMoving</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>

<span class="w">      </span><span class="k">while</span><span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">LOWER_DESK_BUTTON</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HIGH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Do nothing and wait till the button is released</span>
<span class="w">        </span><span class="n">delay</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">move</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="n">LOWER_DIRECTION</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">delay</span><span class="p">(</span><span class="n">LOOP_DELAY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Delaying a bit more, to allow the desk to keep lowering slightly even if min height was reached</span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">RAISE_DESK_BUTTON</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HIGH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;Raise Button is pressed&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isMoving</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stop</span><span class="p">();</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>

<span class="w">      </span><span class="k">while</span><span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="n">RAISE_DESK_BUTTON</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">HIGH</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Do nothing and wait till the button is released</span>
<span class="w">        </span><span class="n">delay</span><span class="p">(</span><span class="mi">20</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="n">move</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="n">RAISE_DIRECTION</span><span class="p">);</span><span class="w"></span>
<span class="w">      </span><span class="n">delay</span><span class="p">(</span><span class="n">LOOP_DELAY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// Delaying a bit more, to allow the desk to keep raising slightly even if max height was reached</span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="n">delay</span><span class="p">(</span><span class="n">LOOP_DELAY</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">move</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">speed</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">direction</span><span class="p">){</span><span class="w"></span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;move() called&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">movingDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">direction</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="n">boolean</span><span class="w"> </span><span class="n">inPin1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LOW</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">boolean</span><span class="w"> </span><span class="n">inPin2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HIGH</span><span class="p">;</span><span class="w"></span>

<span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">LOWER_DIRECTION</span><span class="p">){</span><span class="w"></span>
<span class="w">    </span><span class="n">inPin1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HIGH</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">inPin2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LOW</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">AIN1_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">inPin1</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">AIN2_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">inPin2</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">STBY_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">HIGH</span><span class="p">);</span><span class="w"> </span><span class="c1">// disable standby, powering the motor driver</span>
<span class="w">  </span><span class="n">analogWrite</span><span class="p">(</span><span class="n">PWMA_PIN</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">);</span><span class="w"> </span><span class="c1">// 255 is full speed</span>
<span class="p">}</span><span class="w"></span>

<span class="kt">void</span><span class="w"> </span><span class="nf">stop</span><span class="p">(){</span><span class="w"></span>
<span class="w">  </span><span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">&quot;stop() called&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">movingStartedAt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">movingDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IDLE</span><span class="p">;</span><span class="w"></span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">STBY_PIN</span><span class="p">,</span><span class="w"> </span><span class="n">LOW</span><span class="p">);</span><span class="w"></span>
<span class="w">  </span><span class="n">delay</span><span class="p">(</span><span class="mi">1500</span><span class="p">);</span><span class="w"> </span><span class="c1">// Waiting a bit, so that a long press of a button won&#39;t stop and move it again immediately</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h2 id="result-the-v2-in-action">Result: the V2 in action!</h2>
<video controls>
    <source src="./videos/motorizing-an-ikea-skarsta-standing-desk-v2.mp4" type="video/mp4">
</video>

<h1 id="other-tutorials">Other tutorials</h1>
<ul>
<li><a href="http://cesarmoya.com/blog/motorizing-standup-desk/">http://cesarmoya.com/blog/motorizing-standup-desk/</a>: says 2Nm is needed for torque</li>
<li><a href="https://github.com/aenniw/ARDUINO/tree/master/skarsta">https://github.com/aenniw/ARDUINO/tree/master/skarsta</a></li>
<li><a href="https://github.com/flosommerfeld/ESP8266-IKEA-Skarsta-Trotten-Web-Dashboard">https://github.com/flosommerfeld/ESP8266-IKEA-Skarsta-Trotten-Web-Dashboard</a></li>
<li><a href="https://www.instructables.com/Motorizing-an-IKEA-SKARSTA-Table/">https://www.instructables.com/Motorizing-an-IKEA-SKARSTA-Table/</a>: they use an optional endstop to count how many rotations the motor does, thanks to some flag put on the shaft</li>
<li><a href="https://hackcorrelation.blogspot.com/2015/09/ikea-skarsta-sitstanding-desk-hack.html">https://hackcorrelation.blogspot.com/2015/09/ikea-skarsta-sitstanding-desk-hack.html</a>: says 2Nm is needed for torque</li>
</ul>
</article>
<footer class="grey italic small">
    Last update: Fri 03 May 2024</footer>

        </div> <!-- WRAPPER -->
    </body>
</html>